mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2 * scale_factor), color = "blue") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
}
}
# Create a function that handles multiple variables and creates single plot
library(ggplot2)
library(dplyr)
library(lubridate)
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2), color = "blue", linetype = "dashed") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~., name = paste("Average", variables[2]))
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic() +
theme(axis.title.y.right = element_text(angle = 90, vjust = 0.5, hjust = 0.5)) +
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)))
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
}
}
plot_list_multi$volume_vs_temperature
# Create a function that handles multiple variables and creates single plot
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2 * scale_factor), color = "blue") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
print(p)
}
}
# Create a function that handles multiple variables and creates single plot
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2 * scale_factor), color = "blue", linetype = "dashed") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
print(p)
}
}
# Create a loop that creates plots of specified variables
# List of variables that we want to visualize monthly data
variable_list <- c("temperature", "volume", "price", "wind_production")
# Initialized list to store the plot objects
plot_list <- list()
# Looping through the variable list and applying the plot function for each variable
for (i in variable_list) {
p <- plot_avg_monthly(data = df, variable = i)  # calling the monthly plot function
plot_list[[i]] <- p                             # storing the plot in a list making it accessible later
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
print(p)
}
}
# Create a function that handles multiple variables and creates single plot
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2), color = "blue", linetype = "dashed") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
print(p)
}
}
# Create a function that handles multiple variables and creates single plot
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2 * scale_factor), color = "blue", linetype = "dashed") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
print(p)
}
}
# Loading required packages.
library(tidyverse)  # loads ggplot2, dplyr, readr
library(lubridate)  # for date/time manipulation
# Loading in the data
df <- read_csv("elmarket_13_19.csv")
# Creating a function that plots the average monthly data of a specified variable.
plot_avg_monthly <- function(data, variable) {
# Check if the specified variable is valid
if (variable %in% names(data)) {
# Extract year and month, calculate the average per month
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var = mean(get(variable), na.rm = TRUE))
# Plot
p <- ggplot(avg_data, aes(x = year_month, y = avg_var)) +
geom_line() +
labs(y = paste("Average", variable),
x = "Month",
title = paste("Average Monthly", variable)) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose a variable present in the data frame.")
}
}
# Loading required packages.
library(tidyverse)  # loads ggplot2, dplyr, readr
library(lubridate)  # for date/time manipulation
# Loading in the data
df <- read_csv("elmarket_13_19.csv")
# Creating a function that plots the average monthly data of a specified variable.
plot_avg_monthly <- function(data, variable) {
# Check if the specified variable is valid
if (variable %in% names(data)) {
# Extract year and month, calculate the average per month
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var = mean(get(variable), na.rm = TRUE))
# Plot
p <- ggplot(avg_data, aes(x = year_month, y = avg_var)) +
geom_line() +
labs(y = paste("Average", variable),
x = "Month",
title = paste("Average Monthly", variable)) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose a variable present in the data frame.")
}
}
# Create a loop that creates plots of specified variables
# List of variables that we want to visualize monthly data
variable_list <- c("temperature", "volume", "price", "wind_production")
# Initialized list to store the plot objects
plot_list <- list()
# Looping through the variable list and applying the plot function for each variable
for (i in variable_list) {
p <- plot_avg_monthly(data = df, variable = i)  # calling the monthly plot function
plot_list[[i]] <- p                             # storing the plot in a list making it accessible later
}
# Plot monthly average temperature
plot_list$temperature
# Plot monthly average volume
plot_list$volume
# Plot monthly average price
plot_list$price
# Plot monthly average wind production
plot_list$wind_production.
# Loading required packages.
library(tidyverse)  # loads ggplot2, dplyr, readr
library(lubridate)  # for date/time manipulation
library(patchwork)  # to combine plots into a single plot
# Combine multi variable plots into a single plot
combined_plot <- wrap_plots(plot_list_multi, ncol = 2)
# Loading required packages.
library(tidyverse)  # loads ggplot2, dplyr, readr
library(lubridate)  # for date/time manipulation
library(patchwork)  # to combine plots into a single plot
# Loading in the data
df <- read_csv("elmarket_13_19.csv")
# Creating a function that plots the average monthly data of a specified variable.
plot_avg_monthly <- function(data, variable) {
# Check if the specified variable is valid
if (variable %in% names(data)) {
# Extract year and month, calculate the average per month
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var = mean(get(variable), na.rm = TRUE))
# Plot
p <- ggplot(avg_data, aes(x = year_month, y = avg_var)) +
geom_line() +
labs(y = paste("Average", variable),
x = "Month",
title = paste("Average Monthly", variable)) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose a variable present in the data frame.")
}
}
# Create a function that handles multiple variables and creates single plot
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2 * scale_factor), color = "blue", linetype = "dashed") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Create a loop that creates plots of specified variables
# List of variables that we want to visualize monthly data
variable_list <- c("temperature", "volume", "price", "wind_production")
# Initialized list to store the plot objects
plot_list <- list()
# Looping through the variable list and applying the plot function for each variable
for (i in variable_list) {
p <- plot_avg_monthly(data = df, variable = i)  # calling the monthly plot function
plot_list[[i]] <- p                             # storing the plot in a list making it accessible later
}
# Create a function that handles multiple variables and creates single plot
plot_avg_monthly_multi <- function(data, variables) {
# Check if the specified variable is valid
if (all(variables %in% names(data))) {
# Extract year and month, calculate the average per month of both variables
avg_data <- data %>%
mutate(year_month = floor_date(date, "month")) %>%
group_by(year_month) %>%
summarise(avg_var1 = mean(get(variables[1]), na.rm = TRUE),
avg_var2 = mean(get(variables[2]), na.rm = TRUE),
.groups = "drop")
# Compute a scaling factor to map both variables onto a similar scale
scale_factor <- mean(avg_data$avg_var1, na.rm = TRUE) /
mean(avg_data$avg_var2, na.rm = TRUE)
# Plot
p <- ggplot(avg_data, aes(x = year_month)) +
geom_line(aes(y = avg_var1), color = "red") +
geom_line(aes(y = avg_var2 * scale_factor), color = "blue", linetype = "dashed") +
scale_y_continuous(
name = paste("Average", variables[1]),
sec.axis = sec_axis(~. / scale_factor, name = paste("Average", variables[2])),
labels = scales::number
) +
labs(
x = "Month",
title = paste("Monthly averages of", paste(variables, collapse = " & "))
) +
theme_classic()
return(p)
# If the specified variable is invalid
} else {
stop("Invalid variable name. Choose variables present in the data frame.")
}
}
# Plot relationship between variables
# Initialize empty list
plot_list_multi <- list()
# Loop over variables and store comparison plots in list
for (i in 1:(length(variable_list) - 1)) {
for (j in (i + 1):length(variable_list)) {
current_vars <- c(variable_list[i], variable_list[j])
p <- plot_avg_monthly_multi(df, current_vars)
plot_name <- paste(current_vars, collapse = "_vs_")
plot_list_multi[[plot_name]] <- p
}
}
# Combine multi variable plots into a single plot
combined_plot <- wrap_plots(plot_list_multi, ncol = 2)
combined_plot
?wrap_plots
View(df)
